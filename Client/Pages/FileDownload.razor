@page "/downloader"
@using System.IO
@inject ISnackbar Snackbar
@inject IJSRuntime JS
<PageTitle>TransferMe - Downloader</PageTitle>

<button @onclick="DownloadFile">
    Download File From Stream
</button>

@code{
    private async Task DownloadFile()
    {
        // Retrieve a file
        //the routing is hardcoded for now
        EncFile file = await HttpService.GetFileAsync("api/FileDownload/FileID");

        byte[] data = file.RawBytes;
        string filename = file.Description;

        var fileStream = new MemoryStream(file.RawBytes);
        using var streamRef = new DotNetStreamReference(stream: fileStream);

        // Send the data to JS to actually download the file
        await JS.InvokeVoidAsync("SaveFile", filename, streamRef);
    }
}

